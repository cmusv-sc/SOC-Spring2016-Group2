[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar Collection2 = Package['aldeed:collection2-core'].Collection2;\nvar _ = Package.underscore._;\nvar LocalCollection = Package.minimongo.LocalCollection;\nvar Minimongo = Package.minimongo.Minimongo;\nvar check = Package.check.check;\nvar Match = Package.check.Match;\nvar SimpleSchema = Package['aldeed:simple-schema'].SimpleSchema;\nvar MongoObject = Package['aldeed:simple-schema'].MongoObject;\nvar Mongo = Package.mongo.Mongo;\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// packages/aldeed_schema-deny/lib/deny.js                                             //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\n// Extend the schema options allowed by SimpleSchema                                   // 1\nSimpleSchema.extendOptions({                                                           // 2\n  denyInsert: Match.Optional(Boolean),                                                 // 3\n  denyUpdate: Match.Optional(Boolean),                                                 // 4\n});                                                                                    // 5\n                                                                                       // 6\n// Define validation error messages                                                    // 7\nSimpleSchema.messages({                                                                // 8\n  insertNotAllowed: \"[label] cannot be set during an insert\",                          // 9\n  updateNotAllowed: \"[label] cannot be set during an update\"                           // 10\n});                                                                                    // 11\n                                                                                       // 12\nCollection2.on('schema.attached', function (collection, ss) {                          // 13\n  ss.addValidator(function() {                                                         // 14\n    if (!this.isSet) return;                                                           // 15\n                                                                                       // 16\n    var def = this.definition;                                                         // 17\n                                                                                       // 18\n    if (def.denyInsert && this.isInsert) return \"insertNotAllowed\";                    // 19\n    if (def.denyUpdate && (this.isUpdate || this.isUpsert)) return \"updateNotAllowed\";\n  });                                                                                  // 21\n});                                                                                    // 22\n                                                                                       // 23\n/////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nif (typeof Package === 'undefined') Package = {};\nPackage['aldeed:schema-deny'] = {};\n\n})();\n","servePath":"/packages/aldeed_schema-deny.js"}]